<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rabbit Cage</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <button onclick="goHome()">&#x1F3E0;</button> 
        <span id="headerTitle">Rabbit Cage</span>
        <button onclick="goToRabbitProfile()">&#x1F407;</button>
    </header>

    <div id="cageDetails">
        <form id="rabbitForm" onsubmit="saveData(event)">
            <div>
                <label for="serialNumber">SERIAL NUMBER:</label>
                <input type="text" id="serialNumber" name="serialNumber" required>
            </div>
            <div>
                <label for="breed">BREED:</label>
                <input type="text" id="breed" name="breed">
            </div>
            <div>
                <label for="family">FAMILY:</label>
                <input type="text" id="family" name="family">
            </div>
            <div>
                <label for="birthDate">DATE OF BIRTH:</label>
                <input type="date" id="birthDate" name="birthDate">
            </div>
            <div>
                <label for="weight">WEIGHT:</label>
                <input type="text" id="weight" name="weight">
            </div>

            <div>
                <label for="gender">GENDER:</label>
                <label><input type="radio" name="gender" value="male" onclick="togglePregnancy(false)"> MALE</label>
                <label><input type="radio" name="gender" value="female" onclick="togglePregnancy(true)"> FEMALE</label>
            </div>

            <div id="pregnancyOption" style="display: none;">
                <label>PREGNANT:</label>
                <label><input type="radio" name="pregnant" value="yes" onclick="togglePregnancyDetails(true)"> YES</label>
                <label><input type="radio" name="pregnant" value="no" onclick="togglePregnancyDetails(false)"> NO</label>
            </div>

            <div id="pregnancyDetails" style="display: none;">
                <div>
                    <label for="matedRabbit">MATED RABBIT:</label>
                    <input type="text" id="matedRabbit" name="matedRabbit">
                </div>
                <div>
                    <label for="pregnancyStart">START OF PREGNANCY:</label>
                    <input type="date" id="pregnancyStart" name="pregnancyStart" onchange="scheduleSmsReminder()">
                </div>
                <div>
                    <label for="dueDate">DUE DATE OF PREGNANCY:</label>
                    <input type="date" id="dueDate" name="dueDate">
                </div>
            </div>

            <div>
                <label for="note">NOTE:</label>
                <textarea id="note" name="note"></textarea>
            </div>

            <div class="buttons">
                <button type="submit">SUBMIT</button>
                <button type="button" onclick="goHome()">CANCEL</button>
                <button type="button" onclick="deleteCage()">DELETE CAGE</button>
                <button type="button" onclick="clearForm()">CLEAR FORM</button>
            </div>
        </form>
    </div>

    <div id="homePage" class="cage-list" style="display: none;">
        <div id="cageButtons"></div> 
        <button onclick="addNewCage()">ADD NEW CAGE</button>
    </div>

<script>
    let cages = JSON.parse(localStorage.getItem('cages')) || {}; // Store dynamically added cages

    function togglePregnancy(show) {
        document.getElementById('pregnancyOption').style.display = show ? 'block' : 'none';
        document.getElementById('pregnancyDetails').style.display = 'none'; 
    }

    function togglePregnancyDetails(show) {
        document.getElementById('pregnancyDetails').style.display = show ? 'block' : 'none';
    }

    function scheduleSmsReminder() {
        const pregnancyStart = document.getElementById('pregnancyStart').value;
        if (pregnancyStart) {
            const message = "Rabbit Pregnancy Alert: Rabbit is now pregnant.";
            sendSmsReminder("+639942510329", message);
        }
    }

    function sendSmsReminder(number, message) {
        // This fetch call sends data to your Node.js server (or other backend) to communicate with Arduino
        fetch('/send-sms', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ number: number, message: message }),
        })
        .then(response => response.json())
        .then(data => {
            console.log('SMS sent:', data);
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    }

    // Other form handling JavaScript code goes here...

</script>
</body>
</html>
